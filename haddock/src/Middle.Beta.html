<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Middle.Beta</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><a href="RunRun.RunRun.html"><span class="hs-identifier">RunRun.RunRun</span></a><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><a href="Middle.KNormal.html"><span class="hs-identifier">Middle.KNormal</span></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span class="hs-special">(</span><span class="hs-identifier hs-var">lookup</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">hiding</span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-identifier">beta</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Middle.KNormal.html#K"><span class="hs-identifier hs-type">K</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><a href="Middle.KNormal.html#K"><span class="hs-identifier hs-type">K</span></a><span>
</span><a name="line-9"></a><a name="beta"><a href="Middle.Beta.html#beta"><span class="hs-identifier">beta</span></a></a><span> </span><a name="local-6989586621679069797"><a href="#local-6989586621679069797"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-10"></a><span class="hs-comment">--    eprint e</span><span>
</span><a name="line-11"></a><span>    </span><a href="RunRun.RunRun.html#eputstrln"><span class="hs-identifier hs-var">eputstrln</span></a><span> </span><span class="hs-string">&quot;beta ...&quot;</span><span>
</span><a name="line-12"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679069798"><a href="#local-6989586621679069798"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-13"></a><span>    </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069798"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069797"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Middle.KNormal.html#K"><span class="hs-identifier hs-type">K</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><a href="Middle.KNormal.html#K"><span class="hs-identifier hs-type">K</span></a><span>
</span><a name="line-17"></a><a name="b"><a href="Middle.Beta.html#b"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679069799"><a href="#local-6989586621679069799"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-18"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-19"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Int"><span class="hs-identifier hs-var">Int</span></a><span> </span><span class="hs-identifier">_</span><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-20"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Float"><span class="hs-identifier hs-var">Float</span></a><span> </span><span class="hs-identifier">_</span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-21"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#In"><span class="hs-identifier hs-var">In</span></a><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679069799"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-22"></a><span class="hs-identifier">b</span><span> </span><a name="local-6989586621679069800"><a href="#local-6989586621679069800"><span class="hs-identifier">env</span></a></a><span> </span><a name="local-6989586621679069801"><a href="#local-6989586621679069801"><span class="hs-identifier">e</span></a></a><span>
</span><a name="line-23"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Unary_op"><span class="hs-identifier hs-var">Unary_op</span></a><span> </span><a name="local-6989586621679069805"><a href="#local-6989586621679069805"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679069806"><a href="#local-6989586621679069806"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679069807"><a href="#local-6989586621679069807"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679069808"><a href="#local-6989586621679069808"><span class="hs-identifier">x</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Unary_op"><span class="hs-identifier hs-var">Unary_op</span></a><span> </span><a href="#local-6989586621679069805"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679069806"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679069807"><span class="hs-identifier hs-var">t2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069808"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Arith1"><span class="hs-identifier hs-var">Arith1</span></a><span> </span><a name="local-6989586621679069809"><a href="#local-6989586621679069809"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679069810"><a href="#local-6989586621679069810"><span class="hs-identifier">x</span></a></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Arith1"><span class="hs-identifier hs-var">Arith1</span></a><span> </span><a href="#local-6989586621679069809"><span class="hs-identifier hs-var">arith</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069810"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Arith2"><span class="hs-identifier hs-var">Arith2</span></a><span> </span><a name="local-6989586621679069811"><a href="#local-6989586621679069811"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679069812"><a href="#local-6989586621679069812"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069813"><a href="#local-6989586621679069813"><span class="hs-identifier">y</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Arith2"><span class="hs-identifier hs-var">Arith2</span></a><span> </span><a href="#local-6989586621679069811"><span class="hs-identifier hs-var">arith</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069812"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069813"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Float1"><span class="hs-identifier hs-var">Float1</span></a><span> </span><a name="local-6989586621679069814"><a href="#local-6989586621679069814"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679069815"><a href="#local-6989586621679069815"><span class="hs-identifier">x</span></a></a><span>              </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Float1"><span class="hs-identifier hs-var">Float1</span></a><span> </span><a href="#local-6989586621679069814"><span class="hs-identifier hs-var">arith</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069815"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Float2"><span class="hs-identifier hs-var">Float2</span></a><span> </span><a name="local-6989586621679069816"><a href="#local-6989586621679069816"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679069817"><a href="#local-6989586621679069817"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069818"><a href="#local-6989586621679069818"><span class="hs-identifier">y</span></a></a><span>            </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Float2"><span class="hs-identifier hs-var">Float2</span></a><span> </span><a href="#local-6989586621679069816"><span class="hs-identifier hs-var">arith</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069817"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069818"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Cmp"><span class="hs-identifier hs-var">Cmp</span></a><span> </span><a name="local-6989586621679069819"><a href="#local-6989586621679069819"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679069820"><a href="#local-6989586621679069820"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069821"><a href="#local-6989586621679069821"><span class="hs-identifier">y</span></a></a><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Cmp"><span class="hs-identifier hs-var">Cmp</span></a><span> </span><a href="#local-6989586621679069819"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069820"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069821"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#IfCmp"><span class="hs-identifier hs-var">IfCmp</span></a><span> </span><a name="local-6989586621679069822"><a href="#local-6989586621679069822"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679069823"><a href="#local-6989586621679069823"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069824"><a href="#local-6989586621679069824"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679069825"><a href="#local-6989586621679069825"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679069826"><a href="#local-6989586621679069826"><span class="hs-identifier">e2</span></a></a><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Middle.KNormal.html#IfCmp"><span class="hs-identifier hs-var">IfCmp</span></a><span> </span><a href="#local-6989586621679069822"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069823"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069824"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069825"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069826"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-30"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#FIfCmp"><span class="hs-identifier hs-var">FIfCmp</span></a><span> </span><a name="local-6989586621679069827"><a href="#local-6989586621679069827"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679069828"><a href="#local-6989586621679069828"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069829"><a href="#local-6989586621679069829"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679069830"><a href="#local-6989586621679069830"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679069831"><a href="#local-6989586621679069831"><span class="hs-identifier">e2</span></a></a><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Middle.KNormal.html#FIfCmp"><span class="hs-identifier hs-var">FIfCmp</span></a><span> </span><a href="#local-6989586621679069827"><span class="hs-identifier hs-var">cmp</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069828"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069829"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069830"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069831"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-31"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679069832"><a href="#local-6989586621679069832"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Middle.KNormal.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679069833"><a href="#local-6989586621679069833"><span class="hs-identifier">x'</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679069834"><a href="#local-6989586621679069834"><span class="hs-identifier">e2</span></a></a><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-32"></a><span>                                                </span><a href="RunRun.RunRun.html#eputstrln"><span class="hs-identifier hs-var">eputstrln</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;beta-reducing &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679069832"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; = &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679069833"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-33"></a><span>                                                </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679069832"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679069833"><span class="hs-identifier hs-var">x'</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679069834"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-34"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679069835"><a href="#local-6989586621679069835"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679069836"><a href="#local-6989586621679069836"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679069837"><a href="#local-6989586621679069837"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679069838"><a href="#local-6989586621679069838"><span class="hs-identifier">e2</span></a></a><span>             </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Middle.KNormal.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069835"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679069836"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069837"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069838"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#KLetRec"><span class="hs-identifier hs-var">KLetRec</span></a><span> </span><a name="local-6989586621679069839"><a href="#local-6989586621679069839"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679069840"><a href="#local-6989586621679069840"><span class="hs-identifier">e2</span></a></a><span>                </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679069841"><a href="#local-6989586621679069841"><span class="hs-identifier">e1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Middle.KNormal.html#KLetRec"><span class="hs-identifier hs-var">KLetRec</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069839"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">kbody</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679069841"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">kbody</span><span> </span><a href="#local-6989586621679069839"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069840"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#KApp"><span class="hs-identifier hs-var">KApp</span></a><span> </span><a name="local-6989586621679069842"><a href="#local-6989586621679069842"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069843"><a href="#local-6989586621679069843"><span class="hs-identifier">ys</span></a></a><span>                   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#KApp"><span class="hs-identifier hs-var">KApp</span></a><span> </span><a href="#local-6989586621679069842"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069843"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#If"><span class="hs-identifier hs-var">If</span></a><span> </span><a name="local-6989586621679069844"><a href="#local-6989586621679069844"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069845"><a href="#local-6989586621679069845"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679069846"><a href="#local-6989586621679069846"><span class="hs-identifier">e2</span></a></a><span>                  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Middle.KNormal.html#If"><span class="hs-identifier hs-var">If</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069844"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069845"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069846"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><a name="local-6989586621679069847"><a href="#local-6989586621679069847"><span class="hs-identifier">x</span></a></a><span>                       </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Var"><span class="hs-identifier hs-var">Var</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069847"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a><span> </span><a name="local-6989586621679069848"><a href="#local-6989586621679069848"><span class="hs-identifier">xs</span></a></a><span>                    </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069848"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#LetTuple"><span class="hs-identifier hs-var">LetTuple</span></a><span> </span><a name="local-6989586621679069849"><a href="#local-6989586621679069849"><span class="hs-identifier">xts</span></a></a><span> </span><a name="local-6989586621679069850"><a href="#local-6989586621679069850"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679069851"><a href="#local-6989586621679069851"><span class="hs-identifier">e1</span></a></a><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Middle.KNormal.html#LetTuple"><span class="hs-identifier hs-var">LetTuple</span></a><span> </span><a href="#local-6989586621679069849"><span class="hs-identifier hs-var">xts</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069850"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Middle.Beta.html#b"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679069851"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Array"><span class="hs-identifier hs-var">Array</span></a><span> </span><a name="local-6989586621679069852"><a href="#local-6989586621679069852"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679069853"><a href="#local-6989586621679069853"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069854"><a href="#local-6989586621679069854"><span class="hs-identifier">y</span></a></a><span>                 </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Array"><span class="hs-identifier hs-var">Array</span></a><span> </span><a href="#local-6989586621679069852"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069853"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069854"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Out"><span class="hs-identifier hs-var">Out</span></a><span> </span><a name="local-6989586621679069855"><a href="#local-6989586621679069855"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679069856"><a href="#local-6989586621679069856"><span class="hs-identifier">x</span></a></a><span>                     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Out"><span class="hs-identifier hs-var">Out</span></a><span> </span><a href="#local-6989586621679069855"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069856"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679069857"><a href="#local-6989586621679069857"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069858"><a href="#local-6989586621679069858"><span class="hs-identifier">y</span></a></a><span>                     </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069857"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069858"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Put"><span class="hs-identifier hs-var">Put</span></a><span> </span><a name="local-6989586621679069859"><a href="#local-6989586621679069859"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679069860"><a href="#local-6989586621679069860"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679069861"><a href="#local-6989586621679069861"><span class="hs-identifier">z</span></a></a><span>                   </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Put"><span class="hs-identifier hs-var">Put</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069859"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069860"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069861"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Malloc"><span class="hs-identifier hs-var">Malloc</span></a><span> </span><a name="local-6989586621679069862"><a href="#local-6989586621679069862"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679069863"><a href="#local-6989586621679069863"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679069864"><a href="#local-6989586621679069864"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.KNormal.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><a name="local-6989586621679069865"><a href="#local-6989586621679069865"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Malloc"><span class="hs-identifier hs-var">Malloc</span></a><span> </span><a href="#local-6989586621679069862"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679069863"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679069864"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Middle.KNormal.html#A"><span class="hs-identifier hs-var">A</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069865"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="Middle.KNormal.html#Malloc"><span class="hs-identifier hs-var">Malloc</span></a><span> </span><a name="local-6989586621679069866"><a href="#local-6989586621679069866"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679069867"><a href="#local-6989586621679069867"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679069868"><a href="#local-6989586621679069868"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.KNormal.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679069869"><a href="#local-6989586621679069869"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679069801"><span class="hs-identifier hs-var">e</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Middle.KNormal.html#Malloc"><span class="hs-identifier hs-var">Malloc</span></a><span> </span><a href="#local-6989586621679069866"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679069867"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679069868"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Middle.KNormal.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679069802"><span class="hs-identifier hs-var">find</span></a><span> </span><a href="#local-6989586621679069869"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-48"></a><span>        </span><a name="local-6989586621679069802"><a href="#local-6989586621679069802"><span class="hs-identifier">find</span></a></a><span> </span><a name="local-6989586621679069803"><a href="#local-6989586621679069803"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679069803"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679069800"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-49"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679069804"><a href="#local-6989586621679069804"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679069804"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-50"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679069803"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-51"></a></pre></body></html>