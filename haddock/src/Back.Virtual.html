<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Back.Virtual</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span class="hs-special">(</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- import Control.Monad.IO.Class(liftIO)</span><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Monad.State</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">get</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldM</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-7"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data.Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">S</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">notMember</span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><a href="Back.Asm.html"><span class="hs-identifier">Back.Asm</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Asm</span><span> </span><span class="hs-keyword">hiding</span><span class="hs-special">(</span><a href="Back.Asm.html#fv"><span class="hs-identifier hs-var">fv</span></a><span class="hs-special">)</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Middle.Closure_Type.html"><span class="hs-identifier">Middle.Closure_Type</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">C</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="Middle.Closure.html"><span class="hs-identifier">Middle.Closure</span></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure.html#fv"><span class="hs-identifier hs-var">fv</span></a><span class="hs-special">)</span><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="RunRun.Type.html"><span class="hs-identifier">RunRun.Type</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Type</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><a href="RunRun.RunRun.html"><span class="hs-identifier">RunRun.RunRun</span></a><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><a href="Front.Syntax.html"><span class="hs-identifier">Front.Syntax</span></a><span> </span><span class="hs-special">(</span><a href="Front.Syntax.html#Arith_binary"><span class="hs-identifier hs-type">Arith_binary</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- import Back.Block (Id_or_imm (..))</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-identifier">mapinit</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">M.Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span>
</span><a name="line-17"></a><a name="mapinit"><a href="Back.Virtual.html#mapinit"><span class="hs-identifier">mapinit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.singleton</span><span> </span><span class="hs-string">&quot;%r0&quot;</span><span> </span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-identifier">classify</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679100623"><span class="hs-identifier hs-type">t2</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100624"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100624"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100623"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100624"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100624"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100623"><span class="hs-identifier hs-type">t2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100624"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100624"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-20"></a><a name="classify"><a href="Back.Virtual.html#classify"><span class="hs-identifier">classify</span></a></a><span> </span><a name="local-6989586621679100625"><a href="#local-6989586621679100625"><span class="hs-identifier">xts</span></a></a><span> </span><a name="local-6989586621679100626"><a href="#local-6989586621679100626"><span class="hs-identifier">ini</span></a></a><span> </span><a name="local-6989586621679100627"><a href="#local-6989586621679100627"><span class="hs-identifier">addf</span></a></a><span> </span><a name="local-6989586621679100628"><a href="#local-6989586621679100628"><span class="hs-identifier">addi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="#local-6989586621679100629"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679100626"><span class="hs-identifier hs-var">ini</span></a><span> </span><a href="#local-6989586621679100625"><span class="hs-identifier hs-var">xts</span></a><span>
</span><a name="line-21"></a><span>               </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span>               </span><a name="local-6989586621679100629"><a href="#local-6989586621679100629"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679100630"><a href="#local-6989586621679100630"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679100631"><a href="#local-6989586621679100631"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679100632"><a href="#local-6989586621679100632"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679100632"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-23"></a><span>                        </span><a href="RunRun.Type.html#Unit"><span class="hs-identifier hs-var">Type.Unit</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100630"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">;</span><span>
</span><a name="line-24"></a><span>                        </span><a href="RunRun.Type.html#Float"><span class="hs-identifier hs-var">Type.Float</span></a><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100627"><span class="hs-identifier hs-var">addf</span></a><span> </span><a href="#local-6989586621679100630"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679100631"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">;</span><span>
</span><a name="line-25"></a><span>                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100628"><span class="hs-identifier hs-var">addi</span></a><span> </span><a href="#local-6989586621679100630"><span class="hs-identifier hs-var">acc</span></a><span> </span><a href="#local-6989586621679100631"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100632"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-identifier">separate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679100622"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679100622"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679100622"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><a name="separate"><a href="Back.Virtual.html#separate"><span class="hs-identifier">separate</span></a></a><span> </span><a name="local-6989586621679100633"><a href="#local-6989586621679100633"><span class="hs-identifier">xts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Back.Virtual.html#classify"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679100633"><span class="hs-identifier hs-var">xts</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100634"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679100635"><span class="hs-identifier hs-var">f2</span></a><span>
</span><a name="line-29"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-30"></a><span>            </span><a name="local-6989586621679100634"><a href="#local-6989586621679100634"><span class="hs-identifier">f1</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679100636"><a href="#local-6989586621679100636"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679100637"><a href="#local-6989586621679100637"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679100638"><a href="#local-6989586621679100638"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100636"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100637"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679100638"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>            </span><a name="local-6989586621679100635"><a href="#local-6989586621679100635"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679100639"><a href="#local-6989586621679100639"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679100640"><a href="#local-6989586621679100640"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679100641"><a href="#local-6989586621679100641"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100639"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679100641"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100640"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-identifier">expand</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679100620"><span class="hs-identifier hs-type">t3</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100621"><span class="hs-identifier hs-type">t4</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100620"><span class="hs-identifier hs-type">t3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100621"><span class="hs-identifier hs-type">t4</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100621"><span class="hs-identifier hs-type">t4</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100620"><span class="hs-identifier hs-type">t3</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100621"><span class="hs-identifier hs-type">t4</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100621"><span class="hs-identifier hs-type">t4</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100621"><span class="hs-identifier hs-type">t4</span></a><span class="hs-special">)</span><span>
</span><a name="line-35"></a><a name="expand"><a href="Back.Virtual.html#expand"><span class="hs-identifier">expand</span></a></a><span> </span><a name="local-6989586621679100642"><a href="#local-6989586621679100642"><span class="hs-identifier">xts</span></a></a><span> </span><a name="local-6989586621679100643"><a href="#local-6989586621679100643"><span class="hs-identifier">ini</span></a></a><span> </span><a name="local-6989586621679100644"><a href="#local-6989586621679100644"><span class="hs-identifier">addf</span></a></a><span> </span><a name="local-6989586621679100645"><a href="#local-6989586621679100645"><span class="hs-identifier">addi</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">(</span><a href="Back.Virtual.html#classify"><span class="hs-identifier hs-var">classify</span></a><span> </span><a href="#local-6989586621679100642"><span class="hs-identifier hs-var">xts</span></a><span> </span><a href="#local-6989586621679100643"><span class="hs-identifier hs-var">ini</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679100646"><a href="#local-6989586621679100646"><span class="hs-identifier">offset</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679100647"><a href="#local-6989586621679100647"><span class="hs-identifier">acc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679100648"><a href="#local-6989586621679100648"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100646"><span class="hs-identifier hs-var">offset</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">4</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100644"><span class="hs-identifier hs-var">addf</span></a><span> </span><a href="#local-6989586621679100648"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100646"><span class="hs-identifier hs-var">offset</span></a><span> </span><a href="#local-6989586621679100647"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679100649"><a href="#local-6989586621679100649"><span class="hs-identifier">offset</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679100650"><a href="#local-6989586621679100650"><span class="hs-identifier">acc</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679100651"><a href="#local-6989586621679100651"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100652"><a href="#local-6989586621679100652"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100649"><span class="hs-identifier hs-var">offset</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">4</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100645"><span class="hs-identifier hs-var">addi</span></a><span> </span><a href="#local-6989586621679100651"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100652"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679100649"><span class="hs-identifier hs-var">offset</span></a><span> </span><a href="#local-6989586621679100650"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">-- g env globals exp</span><span>
</span><a name="line-42"></a><span class="hs-identifier">g</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">M.Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="RunRun.Type.html#Type"><span class="hs-identifier hs-type">Type.Type</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Middle.Closure_Type.html#C"><span class="hs-identifier hs-type">C.C</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><a href="Back.Asm.html#T"><span class="hs-identifier hs-type">T</span></a><span>
</span><a name="line-43"></a><a name="g"><a href="Back.Virtual.html#g"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-identifier">_</span><span>  </span><a href="Middle.Closure_Type.html#Unit"><span class="hs-identifier hs-var">C.Unit</span></a><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><a href="Back.Asm.html#Nop"><span class="hs-identifier hs-var">Nop</span></a><span>
</span><a name="line-44"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Int"><span class="hs-identifier hs-var">C.Int</span></a><span> </span><a name="local-6989586621679100653"><a href="#local-6989586621679100653"><span class="hs-identifier">i</span></a></a><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100653"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Float"><span class="hs-identifier hs-var">C.Float</span></a><span> </span><a name="local-6989586621679100654"><a href="#local-6989586621679100654"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#FLi"><span class="hs-identifier hs-var">FLi</span></a><span> </span><a href="#local-6989586621679100654"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Out"><span class="hs-identifier hs-var">C.Out</span></a><span> </span><a name="local-6989586621679100655"><a href="#local-6989586621679100655"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679100656"><a href="#local-6989586621679100656"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Out"><span class="hs-identifier hs-var">Out</span></a><span> </span><a href="#local-6989586621679100655"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679100656"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#In"><span class="hs-identifier hs-var">C.In</span></a><span> </span><a name="local-6989586621679100657"><a href="#local-6989586621679100657"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#In"><span class="hs-identifier hs-var">In</span></a><span> </span><a href="#local-6989586621679100657"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Unary_op"><span class="hs-identifier hs-var">C.Unary_op</span></a><span> </span><a name="local-6989586621679100658"><a href="#local-6989586621679100658"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679100659"><a href="#local-6989586621679100659"><span class="hs-identifier">t1</span></a></a><span> </span><a name="local-6989586621679100660"><a href="#local-6989586621679100660"><span class="hs-identifier">t2</span></a></a><span> </span><a name="local-6989586621679100661"><a href="#local-6989586621679100661"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Unary_op"><span class="hs-identifier hs-var">Unary_op</span></a><span> </span><a href="#local-6989586621679100658"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679100659"><span class="hs-identifier hs-var">t1</span></a><span> </span><a href="#local-6989586621679100660"><span class="hs-identifier hs-var">t2</span></a><span> </span><a href="#local-6989586621679100661"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Arith1"><span class="hs-identifier hs-var">C.Arith1</span></a><span> </span><a name="local-6989586621679100662"><a href="#local-6989586621679100662"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679100663"><a href="#local-6989586621679100663"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Arith1"><span class="hs-identifier hs-var">Arith1</span></a><span> </span><a href="#local-6989586621679100662"><span class="hs-identifier hs-var">arith</span></a><span> </span><a href="#local-6989586621679100663"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Arith2"><span class="hs-identifier hs-var">C.Arith2</span></a><span> </span><a name="local-6989586621679100664"><a href="#local-6989586621679100664"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679100665"><a href="#local-6989586621679100665"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100666"><a href="#local-6989586621679100666"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Arith2"><span class="hs-identifier hs-var">Arith2</span></a><span> </span><a href="#local-6989586621679100664"><span class="hs-identifier hs-var">arith</span></a><span> </span><a href="#local-6989586621679100665"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100666"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Float1"><span class="hs-identifier hs-var">C.Float1</span></a><span> </span><a name="local-6989586621679100667"><a href="#local-6989586621679100667"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679100668"><a href="#local-6989586621679100668"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Float1"><span class="hs-identifier hs-var">Float1</span></a><span> </span><a href="#local-6989586621679100667"><span class="hs-identifier hs-var">arith</span></a><span> </span><a href="#local-6989586621679100668"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Float2"><span class="hs-identifier hs-var">C.Float2</span></a><span> </span><a name="local-6989586621679100669"><a href="#local-6989586621679100669"><span class="hs-identifier">arith</span></a></a><span> </span><a name="local-6989586621679100670"><a href="#local-6989586621679100670"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100671"><a href="#local-6989586621679100671"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Float2"><span class="hs-identifier hs-var">Float2</span></a><span> </span><a href="#local-6989586621679100669"><span class="hs-identifier hs-var">arith</span></a><span> </span><a href="#local-6989586621679100670"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100671"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Cmp"><span class="hs-identifier hs-var">C.Cmp</span></a><span> </span><a name="local-6989586621679100672"><a href="#local-6989586621679100672"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679100673"><a href="#local-6989586621679100673"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100674"><a href="#local-6989586621679100674"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">------------ have to check type !!!!!!!!!</span><span>
</span><a name="line-54"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Cmp"><span class="hs-identifier hs-var">Cmp</span></a><span> </span><a href="#local-6989586621679100672"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679100673"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100674"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100675"><a href="#local-6989586621679100675"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#If"><span class="hs-identifier hs-var">C.If</span></a><span> </span><a name="local-6989586621679100676"><a href="#local-6989586621679100676"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100677"><a href="#local-6989586621679100677"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679100678"><a href="#local-6989586621679100678"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-56"></a><span>        </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#If"><span class="hs-identifier hs-var">If</span></a><span> </span><a href="#local-6989586621679100676"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100675"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100677"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100675"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100678"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100679"><a href="#local-6989586621679100679"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#IfCmp"><span class="hs-identifier hs-var">C.IfCmp</span></a><span> </span><a name="local-6989586621679100680"><a href="#local-6989586621679100680"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679100681"><a href="#local-6989586621679100681"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100682"><a href="#local-6989586621679100682"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679100683"><a href="#local-6989586621679100683"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679100684"><a href="#local-6989586621679100684"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-58"></a><span>        </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#IfCmp"><span class="hs-identifier hs-var">IfCmp</span></a><span> </span><a href="#local-6989586621679100680"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679100681"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100682"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100679"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100683"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100679"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100684"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100685"><a href="#local-6989586621679100685"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#FIfCmp"><span class="hs-identifier hs-var">C.FIfCmp</span></a><span> </span><a name="local-6989586621679100686"><a href="#local-6989586621679100686"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679100687"><a href="#local-6989586621679100687"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100688"><a href="#local-6989586621679100688"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679100689"><a href="#local-6989586621679100689"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679100690"><a href="#local-6989586621679100690"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-60"></a><span>        </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#FIfCmp"><span class="hs-identifier hs-var">FIfCmp</span></a><span> </span><a href="#local-6989586621679100686"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679100687"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100688"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100685"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100689"><span class="hs-identifier hs-var">e1</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100685"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100690"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100691"><a href="#local-6989586621679100691"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Let"><span class="hs-identifier hs-var">C.Let</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679100692"><a href="#local-6989586621679100692"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679100693"><a href="#local-6989586621679100693"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679100694"><a href="#local-6989586621679100694"><span class="hs-identifier">e1</span></a></a><span> </span><a name="local-6989586621679100695"><a href="#local-6989586621679100695"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-62"></a><span>        </span><a name="local-6989586621679100696"><a href="#local-6989586621679100696"><span class="hs-identifier">e1'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679100691"><span class="hs-identifier hs-var">env</span></a><span> </span><a href="#local-6989586621679100694"><span class="hs-identifier hs-var">e1</span></a><span>
</span><a name="line-63"></a><span>        </span><a name="local-6989586621679100697"><a href="#local-6989586621679100697"><span class="hs-identifier">e2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.insert</span><span> </span><a href="#local-6989586621679100692"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100693"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679100691"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100695"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-64"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#concat"><span class="hs-identifier hs-var">Asm.concat</span></a><span> </span><a href="#local-6989586621679100696"><span class="hs-identifier hs-var">e1'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100692"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100693"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100697"><span class="hs-identifier hs-var">e2'</span></a><span>
</span><a name="line-65"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100698"><a href="#local-6989586621679100698"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Var"><span class="hs-identifier hs-var">C.Var</span></a><span> </span><a name="local-6989586621679100699"><a href="#local-6989586621679100699"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="RunRun.Type.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100700"><span class="hs-identifier hs-var">f</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><a href="Back.Asm.html#Nop"><span class="hs-identifier hs-var">Nop</span></a><span>
</span><a name="line-67"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="RunRun.Type.html#Float"><span class="hs-identifier hs-var">Float</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100700"><span class="hs-identifier hs-var">f</span></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#FMv"><span class="hs-identifier hs-var">FMv</span></a><span> </span><a href="#local-6989586621679100699"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Mv"><span class="hs-identifier hs-var">Mv</span></a><span> </span><a href="#local-6989586621679100699"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679100700"><a href="#local-6989586621679100700"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.lookup</span><span> </span><a href="#local-6989586621679100699"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100698"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-70"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100701"><a href="#local-6989586621679100701"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Tuple"><span class="hs-identifier hs-var">C.Tuple</span></a><span> </span><a name="local-6989586621679100702"><a href="#local-6989586621679100702"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-71"></a><span>        </span><a name="local-6989586621679100703"><a href="#local-6989586621679100703"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;t&quot;</span><span>
</span><a name="line-72"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679100704"><a href="#local-6989586621679100704"><span class="hs-identifier">ofset</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679100705"><a href="#local-6989586621679100705"><span class="hs-identifier">store_tmp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Back.Virtual.html#expand"><span class="hs-identifier hs-var">expand</span></a><span>
</span><a name="line-73"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100706"><a href="#local-6989586621679100706"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100706"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100701"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679100706"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100702"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>                </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span class="hs-special">(</span><a href="Back.Asm.html#Mv"><span class="hs-identifier hs-var">Mv</span></a><span> </span><a href="#local-6989586621679100703"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100707"><a href="#local-6989586621679100707"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100708"><a href="#local-6989586621679100708"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100709"><a href="#local-6989586621679100709"><span class="hs-identifier">store_elem</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100709"><span class="hs-identifier hs-var">store_elem</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100710"><a href="#local-6989586621679100710"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sf"><span class="hs-identifier hs-var">Sf</span></a><span> </span><a href="#local-6989586621679100707"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100703"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100708"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100710"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100711"><a href="#local-6989586621679100711"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679100712"><a href="#local-6989586621679100712"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100713"><a href="#local-6989586621679100713"><span class="hs-identifier">store_elem</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100713"><span class="hs-identifier hs-var">store_elem</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100714"><a href="#local-6989586621679100714"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100711"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100703"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100712"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100714"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>                </span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>        </span><a name="local-6989586621679100715"><a href="#local-6989586621679100715"><span class="hs-identifier">store</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100705"><span class="hs-identifier hs-var">store_tmp</span></a><span>
</span><a name="line-79"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100703"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Tuple"><span class="hs-identifier hs-var">Tuple</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100716"><a href="#local-6989586621679100716"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100701"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679100716"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100702"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Mv"><span class="hs-identifier hs-var">Mv</span></a><span> </span><a href="Back.Asm.html#reg_hp"><span class="hs-identifier hs-var">reg_hp</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-80"></a><span>                        </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#reg_hp"><span class="hs-identifier hs-var">reg_hp</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Arith2"><span class="hs-identifier hs-var">Arith2</span></a><span> </span><a href="Front.Syntax.html#Add"><span class="hs-identifier hs-var">Add</span></a><span> </span><a href="Back.Asm.html#reg_hp"><span class="hs-identifier hs-var">reg_hp</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100704"><span class="hs-identifier hs-var">ofset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100715"><span class="hs-identifier hs-var">store</span></a><span>
</span><a name="line-81"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100717"><a href="#local-6989586621679100717"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#LetTuple"><span class="hs-identifier hs-var">C.LetTuple</span></a><span> </span><a name="local-6989586621679100718"><a href="#local-6989586621679100718"><span class="hs-identifier">xts</span></a></a><span> </span><a name="local-6989586621679100719"><a href="#local-6989586621679100719"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679100720"><a href="#local-6989586621679100720"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-82"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679100721"><a href="#local-6989586621679100721"><span class="hs-identifier">fvset</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Middle.Closure.html#fv"><span class="hs-identifier hs-var">fv</span></a><span> </span><a href="#local-6989586621679100720"><span class="hs-identifier hs-var">e2</span></a><span> </span><span class="hs-comment">-- Closure.fv</span><span>
</span><a name="line-83"></a><span>        </span><a name="local-6989586621679100722"><a href="#local-6989586621679100722"><span class="hs-identifier">tmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.union</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.fromList</span><span> </span><a href="#local-6989586621679100718"><span class="hs-identifier hs-var">xts</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100717"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100720"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-84"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679100723"><a href="#local-6989586621679100723"><span class="hs-identifier">lo</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Back.Virtual.html#expand"><span class="hs-identifier hs-var">expand</span></a><span> </span><span class="hs-comment">-- value is not monadic here</span><span>
</span><a name="line-85"></a><span>                </span><a href="#local-6989586621679100718"><span class="hs-identifier hs-var">xts</span></a><span>
</span><a name="line-86"></a><span>                </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100722"><span class="hs-identifier hs-var">tmp</span></a><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100724"><a href="#local-6989586621679100724"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100725"><a href="#local-6989586621679100725"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100726"><a href="#local-6989586621679100726"><span class="hs-identifier">load</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">S.notMember</span><span> </span><a href="#local-6989586621679100724"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100721"><span class="hs-identifier hs-var">fvset</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679100726"><span class="hs-identifier hs-var">load</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Back.Asm.html#fletd"><span class="hs-identifier hs-var">fletd</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100724"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Back.Asm.html#Lf"><span class="hs-identifier hs-var">Lf</span></a><span> </span><a href="#local-6989586621679100719"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100725"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100726"><span class="hs-identifier hs-var">load</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100727"><a href="#local-6989586621679100727"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100728"><a href="#local-6989586621679100728"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679100729"><a href="#local-6989586621679100729"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100730"><a href="#local-6989586621679100730"><span class="hs-identifier">load</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">S.notMember</span><span> </span><a href="#local-6989586621679100727"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100721"><span class="hs-identifier hs-var">fvset</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679100730"><span class="hs-identifier hs-var">load</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100727"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679100728"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Lw"><span class="hs-identifier hs-var">Lw</span></a><span> </span><a href="#local-6989586621679100719"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100729"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100730"><span class="hs-identifier hs-var">load</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span>                </span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679100723"><span class="hs-identifier hs-var">lo</span></a><span>
</span><a name="line-91"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100731"><a href="#local-6989586621679100731"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#MakeCls"><span class="hs-identifier hs-var">C.MakeCls</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679100732"><a href="#local-6989586621679100732"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679100733"><a href="#local-6989586621679100733"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Cls"><span class="hs-identifier hs-var">C.Cls</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">C.entry</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679100734"><a href="#local-6989586621679100734"><span class="hs-identifier">l</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">C.actual_fv</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679100735"><a href="#local-6989586621679100735"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679100736"><a href="#local-6989586621679100736"><span class="hs-identifier">e2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-92"></a><span>        </span><a name="local-6989586621679100737"><a href="#local-6989586621679100737"><span class="hs-identifier">e2'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.insert</span><span> </span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100733"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="#local-6989586621679100731"><span class="hs-identifier hs-var">env</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100736"><span class="hs-identifier hs-var">e2</span></a><span>
</span><a name="line-93"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679100738"><a href="#local-6989586621679100738"><span class="hs-identifier">ofset</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679100739"><a href="#local-6989586621679100739"><span class="hs-identifier">store_fv_tmp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Back.Virtual.html#expand"><span class="hs-identifier hs-var">expand</span></a><span>
</span><a name="line-94"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100740"><a href="#local-6989586621679100740"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100740"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100731"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679100740"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100735"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>                </span><span class="hs-special">(</span><span class="hs-number">4</span><span class="hs-special">,</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679100737"><span class="hs-identifier hs-var">e2'</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100741"><a href="#local-6989586621679100741"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679100742"><a href="#local-6989586621679100742"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100743"><a href="#local-6989586621679100743"><span class="hs-identifier">store_fv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100743"><span class="hs-identifier hs-var">store_fv</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100744"><a href="#local-6989586621679100744"><span class="hs-identifier">sfv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sf"><span class="hs-identifier hs-var">Sf</span></a><span> </span><a href="#local-6989586621679100741"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100742"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100744"><span class="hs-identifier hs-var">sfv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100745"><a href="#local-6989586621679100745"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679100746"><a href="#local-6989586621679100746"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100747"><a href="#local-6989586621679100747"><span class="hs-identifier">store_fv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100747"><span class="hs-identifier hs-var">store_fv</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100748"><a href="#local-6989586621679100748"><span class="hs-identifier">sfv</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100745"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100746"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100748"><span class="hs-identifier hs-var">sfv</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>                </span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>        </span><a name="local-6989586621679100749"><a href="#local-6989586621679100749"><span class="hs-identifier">store_fv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100739"><span class="hs-identifier hs-var">store_fv_tmp</span></a><span>
</span><a name="line-100"></a><span>        </span><a name="local-6989586621679100750"><a href="#local-6989586621679100750"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;l&quot;</span><span>
</span><a name="line-101"></a><span>        </span><a name="local-6989586621679100751"><a href="#local-6989586621679100751"><span class="hs-identifier">tmp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100750"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100749"><span class="hs-identifier hs-var">store_fv</span></a><span>
</span><a name="line-102"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679100733"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Mv"><span class="hs-identifier hs-var">Mv</span></a><span> </span><a href="Back.Asm.html#reg_hp"><span class="hs-identifier hs-var">reg_hp</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>                        </span><span class="hs-special">(</span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#reg_hp"><span class="hs-identifier hs-var">reg_hp</span></a><span class="hs-special">,</span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Arith2"><span class="hs-identifier hs-var">Arith2</span></a><span> </span><a href="Front.Syntax.html#Add"><span class="hs-identifier hs-var">Add</span></a><span> </span><a href="Back.Asm.html#reg_hp"><span class="hs-identifier hs-var">reg_hp</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100738"><span class="hs-identifier hs-var">ofset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>                                </span><span class="hs-special">(</span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100750"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#SetL"><span class="hs-identifier hs-var">SetL</span></a><span> </span><a href="#local-6989586621679100734"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100751"><span class="hs-identifier hs-var">tmp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- closure &#28040;&#12375;&#12383;&#12363;&#12425; SetL &#12399;&#20316;&#12425;&#12428;&#12394;&#12356;&#12399;&#12378;.</span><span>
</span><a name="line-105"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100752"><a href="#local-6989586621679100752"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#AppDir"><span class="hs-identifier hs-var">C.AppDir</span></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#L"><span class="hs-identifier hs-var">C.L</span></a><span> </span><a name="local-6989586621679100753"><a href="#local-6989586621679100753"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679100754"><a href="#local-6989586621679100754"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-106"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679100755"><a href="#local-6989586621679100755"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679100756"><a href="#local-6989586621679100756"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Back.Virtual.html#separate"><span class="hs-identifier hs-var">separate</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100757"><a href="#local-6989586621679100757"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100757"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><a href="#local-6989586621679100752"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679100757"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100754"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#CallDir"><span class="hs-identifier hs-var">CallDir</span></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#L"><span class="hs-identifier hs-var">C.L</span></a><span> </span><a href="#local-6989586621679100753"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100755"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679100756"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-108"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Array"><span class="hs-identifier hs-var">C.Array</span></a><span> </span><a name="local-6989586621679100758"><a href="#local-6989586621679100758"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679100759"><a href="#local-6989586621679100759"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100760"><a href="#local-6989586621679100760"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Makearray"><span class="hs-identifier hs-var">Makearray</span></a><span> </span><a href="#local-6989586621679100758"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100759"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100760"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-109"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100761"><a href="#local-6989586621679100761"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Get"><span class="hs-identifier hs-var">C.Get</span></a><span> </span><a name="local-6989586621679100762"><a href="#local-6989586621679100762"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100763"><a href="#local-6989586621679100763"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><a href="RunRun.Type.html#Unit"><span class="hs-identifier hs-var">Type.Unit</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100764"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><a href="Back.Asm.html#Nop"><span class="hs-identifier hs-var">Nop</span></a><span>
</span><a name="line-111"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><a href="RunRun.Type.html#Float"><span class="hs-identifier hs-var">Type.Float</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100764"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-112"></a><span>                </span><a name="local-6989586621679100765"><a href="#local-6989586621679100765"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;o&quot;</span><span>
</span><a name="line-113"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679100763"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;%r0&quot;</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-114"></a><span>                            </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100765"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Slw"><span class="hs-identifier hs-var">Slw</span></a><span> </span><a href="#local-6989586621679100763"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>                                    </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Lf"><span class="hs-identifier hs-var">Lf</span></a><span> </span><a href="#local-6989586621679100762"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100765"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>                        </span><span class="hs-keyword">else</span><span>
</span><a name="line-117"></a><span>                            </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Lf"><span class="hs-identifier hs-var">Lf</span></a><span> </span><a href="#local-6989586621679100762"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100764"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-119"></a><span>                </span><a name="local-6989586621679100766"><a href="#local-6989586621679100766"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;o&quot;</span><span>
</span><a name="line-120"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679100763"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;%r0&quot;</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-121"></a><span>                            </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100766"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Slw"><span class="hs-identifier hs-var">Slw</span></a><span> </span><a href="#local-6989586621679100763"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>                                    </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Lw"><span class="hs-identifier hs-var">Lw</span></a><span> </span><a href="#local-6989586621679100762"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100766"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>                        </span><span class="hs-keyword">else</span><span>
</span><a name="line-124"></a><span>                            </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Lw"><span class="hs-identifier hs-var">Lw</span></a><span> </span><a href="#local-6989586621679100762"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-126"></a><span>                        </span><a href="RunRun.RunRun.html#throw"><span class="hs-identifier hs-var">throw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="RunRun.RunRun.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span> </span><span class="hs-string">&quot;ext array ... oh ...&quot;</span><span>
</span><a name="line-127"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>            </span><a name="local-6989586621679100764"><a href="#local-6989586621679100764"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.lookup</span><span> </span><a href="#local-6989586621679100762"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100761"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-129"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100767"><a href="#local-6989586621679100767"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Put"><span class="hs-identifier hs-var">C.Put</span></a><span> </span><a name="local-6989586621679100768"><a href="#local-6989586621679100768"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100769"><a href="#local-6989586621679100769"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679100770"><a href="#local-6989586621679100770"><span class="hs-identifier">z</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><a href="RunRun.Type.html#Unit"><span class="hs-identifier hs-var">Type.Unit</span></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100771"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><a href="Back.Asm.html#Nop"><span class="hs-identifier hs-var">Nop</span></a><span>
</span><a name="line-131"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><a href="RunRun.Type.html#Float"><span class="hs-identifier hs-var">Type.Float</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100771"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-132"></a><span>                </span><a name="local-6989586621679100772"><a href="#local-6989586621679100772"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;o&quot;</span><span>
</span><a name="line-133"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679100769"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;%r0&quot;</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-134"></a><span>                            </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100772"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Slw"><span class="hs-identifier hs-var">Slw</span></a><span> </span><a href="#local-6989586621679100769"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>                                    </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sf"><span class="hs-identifier hs-var">Sf</span></a><span> </span><a href="#local-6989586621679100770"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679100768"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100772"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>                        </span><span class="hs-keyword">else</span><span>
</span><a name="line-137"></a><span>                            </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sf"><span class="hs-identifier hs-var">Sf</span></a><span> </span><a href="#local-6989586621679100770"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679100768"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100771"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-139"></a><span>                </span><a name="local-6989586621679100773"><a href="#local-6989586621679100773"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;o&quot;</span><span>
</span><a name="line-140"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679100769"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-string">&quot;%r0&quot;</span><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-141"></a><span>                            </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100773"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">,</span><span> </span><a href="RunRun.Type.html#Int"><span class="hs-identifier hs-var">Type.Int</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Slw"><span class="hs-identifier hs-var">Slw</span></a><span> </span><a href="#local-6989586621679100769"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>                                    </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100770"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679100768"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#V"><span class="hs-identifier hs-var">V</span></a><span> </span><a href="#local-6989586621679100773"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>                        </span><span class="hs-keyword">else</span><span>
</span><a name="line-144"></a><span>                            </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100770"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-6989586621679100768"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-146"></a><span>                        </span><a href="RunRun.RunRun.html#throw"><span class="hs-identifier hs-var">throw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="RunRun.RunRun.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span> </span><span class="hs-string">&quot;ext array ... sorry ...&quot;</span><span>
</span><a name="line-147"></a><span>        </span><span class="hs-keyword">where</span><span>
</span><a name="line-148"></a><span>            </span><a name="local-6989586621679100771"><a href="#local-6989586621679100771"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M.lookup</span><span> </span><a href="#local-6989586621679100768"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100767"><span class="hs-identifier hs-var">env</span></a><span>
</span><a name="line-149"></a><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Malloc"><span class="hs-identifier hs-var">C.Malloc</span></a><span> </span><a name="local-6989586621679100774"><a href="#local-6989586621679100774"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679100775"><a href="#local-6989586621679100775"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679100776"><a href="#local-6989586621679100776"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#A"><span class="hs-identifier hs-var">C.A</span></a><span> </span><a name="local-6989586621679100777"><a href="#local-6989586621679100777"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><a href="RunRun.Type.html#Unit"><span class="hs-identifier hs-var">Type.Unit</span></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100774"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><a href="Back.Asm.html#Nop"><span class="hs-identifier hs-var">Nop</span></a><span>
</span><a name="line-151"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="RunRun.Type.html#Array"><span class="hs-identifier hs-var">Type.Array</span></a><span> </span><a href="RunRun.Type.html#Float"><span class="hs-identifier hs-var">Type.Float</span></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100774"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-152"></a><span>                </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;malloc&quot; ++ x</span><span>
</span><a name="line-153"></a><span>                </span><span class="hs-comment">-- liftIO $ print t</span><span>
</span><a name="line-154"></a><span>                </span><a name="local-6989586621679100778"><a href="#local-6989586621679100778"><span class="hs-identifier">addr_</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;ap&quot;</span><span>
</span><a name="line-155"></a><span>                </span><a name="local-6989586621679100780"><a href="#local-6989586621679100780"><span class="hs-identifier">store</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Back.Virtual.html#store_same_value"><span class="hs-identifier hs-var">store_same_value</span></a><span> </span><a href="#local-6989586621679100775"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-156"></a><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100779"><a href="#local-6989586621679100779"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#Sf"><span class="hs-identifier hs-var">Sf</span></a><span> </span><a href="#local-6989586621679100777"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100778"><span class="hs-identifier hs-var">addr_</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100779"><span class="hs-identifier hs-var">offset</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100776"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100778"><span class="hs-identifier hs-var">addr_</span></a><span class="hs-special">,</span><a href="#local-6989586621679100774"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100776"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100780"><span class="hs-identifier hs-var">store</span></a><span>
</span><a name="line-158"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-159"></a><span>                </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;malloc&quot; ++ x</span><span>
</span><a name="line-160"></a><span>                </span><span class="hs-comment">-- liftIO $ print t</span><span>
</span><a name="line-161"></a><span>                </span><a name="local-6989586621679100781"><a href="#local-6989586621679100781"><span class="hs-identifier">addr_</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;ap&quot;</span><span>
</span><a name="line-162"></a><span>                </span><a name="local-6989586621679100783"><a href="#local-6989586621679100783"><span class="hs-identifier">store</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="Back.Virtual.html#store_same_value"><span class="hs-identifier hs-var">store_same_value</span></a><span> </span><a href="#local-6989586621679100775"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-163"></a><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100782"><a href="#local-6989586621679100782"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100777"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100781"><span class="hs-identifier hs-var">addr_</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100782"><span class="hs-identifier hs-var">offset</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100776"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-164"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100781"><span class="hs-identifier hs-var">addr_</span></a><span class="hs-special">,</span><a href="#local-6989586621679100774"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100776"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100783"><span class="hs-identifier hs-var">store</span></a><span>
</span><a name="line-165"></a><span class="hs-identifier">g</span><span> </span><a name="local-6989586621679100784"><a href="#local-6989586621679100784"><span class="hs-identifier">env</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Malloc"><span class="hs-identifier hs-var">C.Malloc</span></a><span> </span><a name="local-6989586621679100785"><a href="#local-6989586621679100785"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679100786"><a href="#local-6989586621679100786"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#T"><span class="hs-identifier hs-var">C.T</span></a><span> </span><a name="local-6989586621679100787"><a href="#local-6989586621679100787"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-166"></a><span>        </span><a name="local-6989586621679100788"><a href="#local-6989586621679100788"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="RunRun.RunRun.html#genid"><span class="hs-identifier hs-var">genid</span></a><span> </span><span class="hs-string">&quot;tp&quot;</span><span>
</span><a name="line-167"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679100789"><a href="#local-6989586621679100789"><span class="hs-identifier">xts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100790"><a href="#local-6989586621679100790"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100790"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679100784"><span class="hs-identifier hs-var">env</span></a><span> </span><span class="hs-operator hs-var">M.!</span><span> </span><a href="#local-6989586621679100790"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100787"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-168"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679100791"><a href="#local-6989586621679100791"><span class="hs-identifier">store_tmp</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Back.Virtual.html#expand"><span class="hs-identifier hs-var">expand</span></a><span>
</span><a name="line-169"></a><span>                </span><a href="#local-6989586621679100789"><span class="hs-identifier hs-var">xts</span></a><span>
</span><a name="line-170"></a><span>                </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Ans"><span class="hs-identifier hs-var">Ans</span></a><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100786"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-171"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100792"><a href="#local-6989586621679100792"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679100793"><a href="#local-6989586621679100793"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100794"><a href="#local-6989586621679100794"><span class="hs-identifier">store_elem</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100794"><span class="hs-identifier hs-var">store_elem</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100795"><a href="#local-6989586621679100795"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sf"><span class="hs-identifier hs-var">Sf</span></a><span> </span><a href="#local-6989586621679100792"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100788"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100793"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100795"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100796"><a href="#local-6989586621679100796"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679100797"><a href="#local-6989586621679100797"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100798"><a href="#local-6989586621679100798"><span class="hs-identifier">store_elem</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679100798"><span class="hs-identifier hs-var">store_elem</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100799"><a href="#local-6989586621679100799"><span class="hs-identifier">st</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Sw"><span class="hs-identifier hs-var">Sw</span></a><span> </span><a href="#local-6989586621679100796"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100788"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100797"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100799"><span class="hs-identifier hs-var">st</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>                </span><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>        </span><a name="local-6989586621679100800"><a href="#local-6989586621679100800"><span class="hs-identifier">store</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679100791"><span class="hs-identifier hs-var">store_tmp</span></a><span>
</span><a name="line-175"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100788"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100785"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Li"><span class="hs-identifier hs-var">Li</span></a><span> </span><a href="#local-6989586621679100786"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679100800"><span class="hs-identifier hs-var">store</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-identifier">store_same_value</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><a href="Back.Asm.html#T"><span class="hs-identifier hs-type">T</span></a><span>
</span><a name="line-182"></a><a name="store_same_value"><a href="Back.Virtual.html#store_same_value"><span class="hs-identifier">store_same_value</span></a></a><span> </span><a name="local-6989586621679100801"><a href="#local-6989586621679100801"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679100802"><a href="#local-6989586621679100802"><span class="hs-identifier">constr</span></a></a><span> </span><a name="local-6989586621679100803"><a href="#local-6989586621679100803"><span class="hs-identifier">ans</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-identifier hs-var">foldM</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100804"><a href="#local-6989586621679100804"><span class="hs-identifier">acc</span></a></a><span> </span><a name="local-6989586621679100805"><a href="#local-6989586621679100805"><span class="hs-identifier">offset</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Back.Asm.html#seq"><span class="hs-identifier hs-var">seq</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100802"><span class="hs-identifier hs-var">constr</span></a><span> </span><a href="#local-6989586621679100805"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100804"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100803"><span class="hs-identifier hs-var">ans</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">(</span><a href="#local-6989586621679100801"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">h</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Middle.Closure_Type.html#Fundef"><span class="hs-identifier hs-type">C.Fundef</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><a href="Back.Asm.html#Afundef"><span class="hs-identifier hs-type">Afundef</span></a><span>
</span><a name="line-189"></a><a name="h"><a href="Back.Virtual.html#h"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Fundef"><span class="hs-identifier hs-var">C.Fundef</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">C.name</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#L"><span class="hs-identifier hs-var">C.L</span></a><span> </span><a name="local-6989586621679100806"><a href="#local-6989586621679100806"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679100807"><a href="#local-6989586621679100807"><span class="hs-identifier">t</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-190"></a><span>    </span><span class="hs-identifier">C.args</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679100808"><a href="#local-6989586621679100808"><span class="hs-identifier">yts</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-191"></a><span>    </span><span class="hs-identifier">C.formal_fv</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679100809"><a href="#local-6989586621679100809"><span class="hs-identifier">zts</span></a></a><span class="hs-special">,</span><span>
</span><a name="line-192"></a><span>    </span><span class="hs-identifier">C.body</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679100810"><a href="#local-6989586621679100810"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-193"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679100811"><a href="#local-6989586621679100811"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679100812"><a href="#local-6989586621679100812"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Back.Virtual.html#separate"><span class="hs-identifier hs-var">separate</span></a><span> </span><a href="#local-6989586621679100808"><span class="hs-identifier hs-var">yts</span></a><span>
</span><a name="line-194"></a><span>            </span><a name="local-6989586621679100813"><a href="#local-6989586621679100813"><span class="hs-identifier">global</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.map</span><span> </span><span class="hs-identifier">typ</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">globals</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-195"></a><span>            </span><a name="local-6989586621679100814"><a href="#local-6989586621679100814"><span class="hs-identifier">ini_</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.insert</span><span> </span><a href="#local-6989586621679100806"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679100807"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.fromList</span><span> </span><a href="#local-6989586621679100808"><span class="hs-identifier hs-var">yts</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">M.union</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.fromList</span><span> </span><a href="#local-6989586621679100809"><span class="hs-identifier hs-var">zts</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">M.union</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100813"><span class="hs-identifier hs-var">global</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">M.union</span><span class="hs-special">`</span><span> </span><a href="Back.Virtual.html#mapinit"><span class="hs-identifier hs-var">mapinit</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100810"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-196"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679100815"><a href="#local-6989586621679100815"><span class="hs-identifier">lo</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Back.Virtual.html#expand"><span class="hs-identifier hs-var">expand</span></a><span> </span><a href="#local-6989586621679100809"><span class="hs-identifier hs-var">zts</span></a><span>
</span><a name="line-197"></a><span>                    </span><span class="hs-special">(</span><span class="hs-number">4</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100814"><span class="hs-identifier hs-var">ini_</span></a><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100816"><a href="#local-6989586621679100816"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679100817"><a href="#local-6989586621679100817"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100818"><a href="#local-6989586621679100818"><span class="hs-identifier">load</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#fletd"><span class="hs-identifier hs-var">fletd</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100816"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><span> </span><a href="Back.Asm.html#Lf"><span class="hs-identifier hs-var">Lf</span></a><span> </span><a href="#local-6989586621679100806"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100817"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679100818"><span class="hs-identifier hs-var">load</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679100819"><a href="#local-6989586621679100819"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679100820"><a href="#local-6989586621679100820"><span class="hs-identifier">t'</span></a></a><span> </span><a name="local-6989586621679100821"><a href="#local-6989586621679100821"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679100822"><a href="#local-6989586621679100822"><span class="hs-identifier">load</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Let"><span class="hs-identifier hs-var">Let</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679100819"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><a href="#local-6989586621679100820"><span class="hs-identifier hs-var">t'</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#Lw"><span class="hs-identifier hs-var">Lw</span></a><span> </span><a href="#local-6989586621679100806"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="Back.Asm.html#C"><span class="hs-identifier hs-var">C</span></a><span> </span><a href="#local-6989586621679100821"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679100822"><span class="hs-identifier hs-var">load</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-200"></a><span>            </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679100807"><span class="hs-identifier hs-var">t</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-201"></a><span>                    </span><a href="RunRun.Type.html#Fun"><span class="hs-identifier hs-var">Type.Fun</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679100823"><a href="#local-6989586621679100823"><span class="hs-identifier">t2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Afundef"><span class="hs-identifier hs-var">Afundef</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">a_name</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Middle.Closure_Type.html#L"><span class="hs-identifier hs-var">C.L</span></a><span> </span><a href="#local-6989586621679100806"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span>
</span><a name="line-202"></a><span>                                                        </span><span class="hs-identifier">a_args</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679100811"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span>
</span><a name="line-203"></a><span>                                                        </span><span class="hs-identifier">a_fargs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679100812"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span>
</span><a name="line-204"></a><span>                                                        </span><span class="hs-identifier">a_body</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679100815"><span class="hs-identifier hs-var">lo</span></a><span class="hs-special">,</span><span>
</span><a name="line-205"></a><span>                                                        </span><span class="hs-identifier">a_ret</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679100823"><span class="hs-identifier hs-var">t2</span></a><span class="hs-special">}</span><span>
</span><a name="line-206"></a><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#throw"><span class="hs-identifier hs-var">throw</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="RunRun.RunRun.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span> </span><span class="hs-string">&quot;wow&quot;</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-identifier">findGlobal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="RunRun.RunRun.html#Global"><span class="hs-identifier hs-type">Global</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><a name="findGlobal"><a href="Back.Virtual.html#findGlobal"><span class="hs-identifier">findGlobal</span></a></a><span> </span><a name="local-6989586621679100824"><a href="#local-6989586621679100824"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">M.lookup</span><span> </span><a href="#local-6989586621679100824"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">globals</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-identifier">virtual</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Middle.Closure_Type.html#Prog"><span class="hs-identifier hs-type">C.Prog</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="RunRun.RunRun.html#RunRun"><span class="hs-identifier hs-type">RunRun</span></a><span> </span><a href="Back.Asm.html#Aprog"><span class="hs-identifier hs-type">Aprog</span></a><span>
</span><a name="line-215"></a><a name="virtual"><a href="Back.Virtual.html#virtual"><span class="hs-identifier">virtual</span></a></a><span> </span><span class="hs-special">(</span><a href="Middle.Closure_Type.html#Prog"><span class="hs-identifier hs-var">C.Prog</span></a><span> </span><a name="local-6989586621679100825"><a href="#local-6989586621679100825"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-216"></a><span>    </span><span class="hs-comment">--eprint e</span><span>
</span><a name="line-217"></a><span>    </span><a href="RunRun.RunRun.html#eputstrln"><span class="hs-identifier hs-var">eputstrln</span></a><span> </span><span class="hs-string">&quot;virtual ...&quot;</span><span>
</span><a name="line-218"></a><span>    </span><a name="local-6989586621679100826"><a href="#local-6989586621679100826"><span class="hs-identifier">e'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Back.Virtual.html#g"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="Back.Virtual.html#mapinit"><span class="hs-identifier hs-var">mapinit</span></a><span> </span><a href="#local-6989586621679100825"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-219"></a><span>    </span><span class="hs-comment">-- eprint e'</span><span>
</span><a name="line-220"></a><span>    </span><a name="local-6989586621679100827"><a href="#local-6989586621679100827"><span class="hs-identifier">fundefs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><a href="Back.Virtual.html#h"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">toplevel</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><span class="hs-identifier hs-var">get</span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span class="hs-comment">--    eprint fundefs'</span><span>
</span><a name="line-222"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Back.Asm.html#Aprog"><span class="hs-identifier hs-var">Aprog</span></a><span> </span><a href="#local-6989586621679100827"><span class="hs-identifier hs-var">fundefs'</span></a><span> </span><a href="#local-6989586621679100826"><span class="hs-identifier hs-var">e'</span></a><span>
</span><a name="line-223"></a></pre></body></html>